# web_vulnerability_scanner.py

from authentication_support import authenticate_user
from crawler_spider import crawl_and_spider
from csrf_scanner import scan_csrf
from directory_traversal_scanner import scan_directory_traversal
from insecure_deserialization_scanner import scan_insecure_deserialization
from rce_scanner import scan_rce
from ssrf_scanner import scan_ssrf
from xss_scanner import scan_xss

def main():
    print("Web Application Vulnerability Scanner")
    print("=====================================")

    while True:
        print("\nSelect an option:")
        print("1. Authenticate User")
        print("2. Crawl and Spider")
        print("3. CSRF Scanner")
        print("4. Directory Traversal Scanner")
        print("5. Insecure Deserialization Scanner")
        print("6. Remote Code Execution Scanner")
        print("7. SSRF Scanner")
        print("8. Cross-Site Scripting (XSS) Scanner")
        print("9. Exit")

        choice = input("Enter your choice: ")

        if choice == "1":
            target_url = input("Enter the target URL: ")
            username = input("Enter the username: ")
            password = input("Enter the password: ")
            authenticate_user(target_url, {"username": username, "password": password})

        elif choice == "2":
            target_url = input("Enter the target URL: ")
            crawl_and_spider(target_url)

        elif choice == "3":
            target_url = input("Enter the target URL: ")
            scan_csrf(target_url)

        elif choice == "4":
            target_url = input("Enter the target URL: ")
            scan_directory_traversal(target_url)

        elif choice == "5":
            target_url = input("Enter the target URL: ")
            scan_insecure_deserialization(target_url)

        elif choice == "6":
            target_url = input("Enter the target URL: ")
            scan_rce(target_url)

        elif choice == "7":
            target_url = input("Enter the target URL: ")
            scan_ssrf(target_url)

        elif choice == "8":
            target_url = input("Enter the target URL: ")
            scan_xss(target_url)

        elif choice == "9":
            print("Exiting the scanner.")
            break

        else:
            print("Invalid choice. Please select a valid option.")

if __name__ == "__main__":
    main()
